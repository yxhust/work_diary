# 工作日常
## 2020-06-05
1. 阅读数据仓库开发规范
- 涉及到阿里系列产品：ADB, EMR。
- 涉及到环境：生产环境、POC（proof of concept测试环境）
- 涉及到数仓层：prod(数据原始层)、ods（）、dwd（DW明细层，经ETL生成的事实表及宽表数据）、dws（轻度汇总数据层，经dwd生成的聚合数据）、dm（数据集市层，事实表与维度表聚合后或宽表加工后的数据层）、dim（维度数据层，保存维度表信息，如日期维度、用户维度、产品维度）

2. idp业务周会
- 业务六月份目标确定。
- 未来涉及到新版本课程内容的数据需求。
- wehub被封后的聊天数据，如何恢复聊天数据的解决方案。

3. 开始使用dbeaver连接hive。

## 2020-06-04
1. 完成业务看板：出勤时段统计，及出勤时段的完课率。
- 样式上，使用了树状图和水平条，工具提示插入表。
- 内容上，找出有意义的潜在指标。
2. 阅读用户画像，学习数据挖掘。


## 2020-06-03
1. idp业务：整理存储学习行为的MongoDB表，确定所需要同步到MySQL库的目标表结构。涉及到MongoDB文档的嵌套字段。
2. 确定idp用户学习习惯看板要完成的功能点：在期数、关卡维度下，出勤时段（只取hour）次数（而非人数）统计，在出勤时段的完课率。目前，纠结于看板样式的呈现方式。
3. 继续阅读用户画像，并整理有用信息到github。

## 2020-06-02
1. 社群的用户表，因wehub被限制，如今开发使用opendns作为解决方案，登录微信全量更新好友关系。
2. tableau看板：行功能区有聚合维度，对看板呈现的影响。[维度聚合资料](https://help.tableau.com/current/pro/desktop/zh-cn/calculations_aggregation.htm#tableau-%E4%B8%AD%E9%A2%84%E5%AE%9A%E4%B9%89%E8%81%9A%E5%90%88%E7%9A%84%E5%88%97%E8%A1%A8)
```
对维度聚合，返回度量或维度中的所有唯一值。
因此，min(date([填写时间]))字段在行功能区，会呈现度量区的唯一值，度量区会按列功能区展开。
若不添加列功能区，呈现度量区唯一值，若唯一值对应的min(date([填写时间]))只有一个时间，则显示一行（该最小时间对应的度量区唯一值）
tableau呈现不存在管道关系，不会先计算维度再呈现度量区。
```

3. 周会收获
- 神策登录id(业务系统的openid)与业务数据库user_id的ID-map抽样验证。
   - 获取神策id、设备id、登录id等，读取文件为datafram
   - 利用获取的神策登录id作为业务数据库的openid查询，结果保存为dataframe
   - 两dataframe左联结（使用pd.merge），完美匹配上。逻辑是这样的：1000个登录id能查到多少个业务数据库的user_id，这个需要验证，这里使用datafram联结。
- tableau看板，若不止能提供数据可视化呈现，还能再呈现的基础上给出分析，那才是完美。
- 时间序列模型预测。思路很好，需要学习。
- 埋点要完成两件事：一是区别不同事件的埋点，二是埋点事件的返回值。
- 后裔采集器：前谷歌技术团队倾力打造，基于人工智能技术，只需输入网址就能自动识别采集内容 (http://www.houyicaiji.com/)

## 2020-06-01
- 六一儿童节，有怀旧零食，更让人喜欢的是刻着名字的印章，盖了整整一页纸，很好玩。
- 完成满意度问卷看板迭代，看板兼容两个版本问卷：
   - SQL兼容两个版本问卷，可以使用in 或者union  all，结合具体业务来实现
   - 问卷选项题干兼容，使用case表达式，使用SQL或者tableau函数都可以
   - 问卷选项内容兼容，使用case表达式。
   - 问卷推送规则、满意度指标、填写率等，需要与业务商量一起。
- 讨论流失用户问题以及wehub工具对wechat社群运营的影响
   - 问题：由于wehub工具被限制，添加用户这个行动发生了，但基于wehub的wechat_user_friends的数据表是否会更新数据呢？（原数据肯定有，wehub限制了，用户关系是否会更新呢？）
   - 猜想：聊天记录只有wehub被使用才会采集到wechat_chat_records表，用户关系是不是也如此呢？
   - 实际原因：明日问开发
   - 与开发沟通后消息同步：开发临时使用opendns完成用户好友关系维护，登录微信全量更新用户最新关系，解决了因wehub受限造成的社群用户表不更新的问题。

## 2020-05-31
- 写个周记（本子上），这周坚持的事下周还得坚持。
- 开个《数据挖掘：理论与算法》的视频学习沉淀文档


## 2020-05-30
- 学习《数据挖掘：理论与算法》，在宏观层面有所学习，如幸存者偏差、时间维度对数据分析的影响
- 找到《浪潮之巅》，去阅读。


## 2020-05-29
- 参加IDP各线负责人周会
   1. 管理者融入各业务线同学工作中，有利于了解底下业务情况，关心业务同学状态，业务人员往往报以高效工作
   2. 计划A和计划B，两计划会占用资源但每个计划占用资源都不是全部的。设计一个计划C，拉上全部资源，做一个最小化完整产品。
   3. 数据自己完成的看板，站在业务视角，会不会实用呢？因此，记录需求的issue还是很有必要的。
   4. 数据能支持决策，支持迭代，如何科学地预设获取数据，如何在预设时提供科学的支持呢?
- python连接数据库，学习使用连接类来完成代码，而不是散装函数。
- 学习[数据挖掘：理论与算法](https://www.bilibili.com/video/BV1gE411p73X?p=7)
   



## 2020-05-28
1. 整理用户画像的指标体系，熟悉确定标签名称的思路： `先确定标签主题，多个一级归类，多个标签名称`。

   指标  ——> 根据业务线梳理用户画像涉及的主题 ——> 标签
2. 确定IDP业务的课程行为标签实验



## 2020-05-27
- Tableau文本格式说明：
  - 正文：宋体，9号。
  - 行列字段引用：宋体，9号，加粗，并以[字段]表示。
  - 文本标题：宋体，12号，加粗。
  - 字母：Times New Roman
  - 字段值：普通正文，加<value>表示。
- Tableau阴影色彩说明：
  - [ ] 一直使用不好，对调色方案还需要学习
  - 阴影格式：工作表颜色，区颜色，标题颜色
  - 仪表板阴影：颜色
  - 仪表板对象：布局 > 背景颜色
- Tableau字段处理经验：
  - 创建分层，一是减小看板的显示内容，二是提供交互体验给予使用者，需要细粒度就下钻。一般是相关的维度创建分层，不相关的分层意义不大。
  - 统计次数方式
    - `SUM(IF [消息发送者]!=[nickname] THEN 1 
    ELSE 0 END)`,满足条件的行赋值为1（新字段，没显示，sum后显示），累加后即为新创建字段。
    - 满足条件的行赋值为某字段的值（新字段，没显示，countd后显示），计数后即为新创建的字段。
    ```
      // 学员发送消息，的活跃天数
    COUNTD(if not ISNULL([消息类型]) and [nickname]!=[消息发送者]
    then [入门课Day] end)
    ```
    - 两种方式都可以来完成计数。
    - 要使新创建的字段表达出数据分析师想呈现的数据效果，注意在行列功能区拖动维度指标，依据维度展开数据计算。
    - 上述计算方式依据视图而变化，等同于聚合表达式include。`{include :COUNTD(if not ISNULL([消息类型]) and [nickname]!=[消息发送者]
    then [入门课Day] end)}`
  - 在计算比例时，如[总人数]由fixed聚合而成，分子必须也得是聚合表达式。
  ```
    {include [remark]:sum(if CONTAINS([聊天文本],'我要参加') 
  then 1
  ELSE null 
  END)}/[总人数]
  ```
  -  `在写tableau计算公式时，要有数据源的行列印象`。
- Tableau字段排序
  - 按照另一行列的结果排序，间接完成目标行列的排序，即依据`字段`排序。
- Tableau工具提示
  - 参与视图的字段，才可以被用做`标记区`的`工具提示`插入，即使该字段只是以颜色显示也可以。
  - 想显示在`工具提示`里，但不想显示在视图行列里，可以不勾选`显示标题`。
  
  





## 2020-05-26
- [ ] IDP私聊记录
- 指标确定
  - 消息数应答积极度=学员发送消息数/助教发送消息数
  - 天数应答活跃度=学员活跃天数/助教活跃天数
  - 助教日均消息数=助教发送消息数/助教活跃天数
  - 学员日均消息数=学员发送消息数/学员活跃天数
  - 学员发送消息活跃时间段，在每个学员维度上展开，按两种方式度量：
    - 一是按时段，以0到23小时进行统计，
    - 二是按星期，以1到7进行统计，
- 实现方式
  - tableau计算
    - 时间函数：
      - DATEPART(date_part, date, [start_of_week]) ：根据date_part返回date相应的整数数值
      - DATETRUNC(date_part, date, [start_of_week])：根据date_part返回date相应的截断的制定日期，如以月份级别截断处于月份中间的日期时，此函数返回当月的第一天。
    - 活跃时间段使用DATEPART函数即可，注意date_part取值：
    - https://help.tableau.com/current/pro/desktop/zh-cn/functions_functions_date.htm#datepart-%E5%80%BC
    - https://help.tableau.com/current/pro/desktop/zh-cn/functions_operators.htm#%E8%AE%A1%E7%AE%97%E7%9A%84%E7%BB%84%E4%BB%B6
    - 
    - 参数的灵活使用，给予看板交互式体验
  

## 附注2020-04-30
- [ ] 继续完成相关代码

## 附注2020-04-29
- [ ] 深度完善IDP入门课用户数据分析框架，即剖析需求，需要什么，我该做完什么
- [ ] 开始编写相关的Python代码

## 附注2020-04-28 
* [x] 分析IDP入门课用户数据分析框架
* [ ] [medium推荐文章](https://medium.muz.li/10-rules-of-dashboard-design-f1a4123028a2)

